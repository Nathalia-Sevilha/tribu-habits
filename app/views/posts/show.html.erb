<div class=" community_style">

  <%= render partial: "shared/header",  locals: { zone: @post, suffix: " - Comments"}  %>

  <section class="container" >
    <div class="card_style">
      <div class="d-flex flex-column justify-content-center align-items-start mb-2">
        <h5><%= @post.title %></h5>
        <p style="color: var(--community-text-color);"><%= @post.content %></p>
      </div>

      <div class="border-top d-flex justify-content-start align-items-center py-4" >
        <i class="fa-regular fa-comment-dots " style="margin-right:5px"></i>
        <p class="p-0 m-0" style="color: var(--community-text-color);"> <%= @comments.length%> comments</p>
      </div>

      <%# -----------comments---------- %>

    <% @comments.each do |comment| %>
    <div class="bg-gray rounded my-2 p-3">
     <div class="d-flex flex-row justify-content-between mb-2 bg-gray" style="color: var(--community-text-color);">
        <div class="d-flex flex-row justify-content-start align-items-center">
          <% if comment.user&.photo&.attached? %>
            <%= cl_image_tag comment.user.photo.key, class: "user-comments-img" %>
          <% else %>
            <%= image_tag "user-avatar.svg", class: "user-comments-img" %>
          <% end %>

           <h5  class="m-0 mx-1 h6 fw-normal text-black"><%= comment.user.username%></h5>
            <small class="text-dark-gray px-2" style="font-size: 12px;"><%= time_ago_in_words(comment.created_at) %> ago</small>
          </div>

          <div class="d-flex flex-row align-items-center">

            <%# ------- delete comment ------- %>
            <% if comment.user == current_user %>
              <form  action="<%= community_post_comment_path(@community, @post, comment) %>" method="post" onsubmit="return confirm('Are you sure you want to delete this comment?');">
                <input type="hidden" name="_method" value="delete">
                <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
                <button type="submit" class="trash_icon_button">
                  <i class="fa-solid fa-trash-can"></i>
                </button>
              </form>
            <% end %>
          </div>
          </div>
         <p style="color: var(--community-text-color);"><%=comment.content %></p>
       </div>
  <% end %>
      </div>
  </section>
</div>
